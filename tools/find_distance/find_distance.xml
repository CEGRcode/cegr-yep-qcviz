<tool id="find_distance" name="Find Distance" version="1.0.0">
    <description>
        from Features to Peaks
    </description>
    <requirements>
        <requirement type="package" version="1.14.2">numpy</requirement>
        <requirement type="package" version="2.7.14">python</requirement>
        <requirement type="package" version="0.22.0">pandas</requirement>
    </requirements>
    <command detect_errors="exit_code">
        <![CDATA[
      python '$__tool_directory__/find_distance.py' '$peak_file' '$features_bound' '$ref_feature' '$sector_threshold'
    ]]>
    </command>

    <inputs>
        <param name="peak_file" type="data" format="bed" label="Bedfile containing peaks"/>
        <param name="features_bound" type="data" format="bed" label=" Bound Features" help="file generated by pickFeatures"/>
        <param name="ref_feature" type="data" format="bed" label=" Reference feature bedfile "/>
        <param name="sector_threshold" type="integer" value="2" label=" Sector Threshold "/>
    </inputs>

    <outputs>
        <data name="outfile" format="bed" from_work_dir="finalDist.bed"/>
    </outputs>

    <tests>
        <test>
            <param name="peak_file" ftype="bed" value="peaks.bed"/>
            <param name="features_bound" ftype="bed" value="boundFeatures.bed"/>
            <param name="ref_feature" ftype="bed" value="nfr.bed"/>
            <param name="sector_threshold"  value="2" />
            <output name="outfile" file="finalDist.bed" ftype="bed"/>
        </test>
        <test>
            <param name="peak_file" ftype="bed" value="peaks.bed"/>
            <param name="features_bound" ftype="bed" value="fewbound.bed"/>
            <param name="ref_feature" ftype="bed" value="nfr.bed"/>
            <param name="sector_threshold"  value="4" />
            <output name="outfile" file="fewDist.bed" ftype="bed"/>
        </test>
    </tests>

    <help>
        <![CDATA[
**What it does**

----

This script first finds the distance between each peak and bound features, to find the bound features that have atleast one peak associated with them (chooses the nearest distance as the smallest absolute distance in case there is more than one region). Lastly, reports the corresponding reference Feature for each bound feature sorted by the most upstream to downstream distance.

Outputs the reference feature if the no.of bound Features are equal to no.of reference features and also if no.of bound features are less than equal to sector threshold specified.
    ]]>
    </help>
    <citations>
        <citation type="bibtex">
            @unpublished{None, author = {Kuntala, Prashant Kumar}, title = {None}, year = {None}, eprint = {None}, url = {http://www.pughlab.psu.edu/} }</citation>
    </citations>
</tool>
